# ==============================================================================
# 00-login.http - Smoke Test & Customer Login
# ==============================================================================
# Run this first to verify the API is reachable and get your auth token.
#
# After login succeeds:
#   1. Copy the "token" value from the response
#   2. Paste it into CUSTOMER_TOKEN in docs/api/http/.env
#   3. Then run 10-entitlements.http to get your entitlement ID
# ==============================================================================

# File variables (loaded from .env)
@apiBase = {{$dotenv API_BASE}}
@customerEmail = {{$dotenv CUSTOMER_EMAIL}}
@customerPassword = {{$dotenv CUSTOMER_PASSWORD}}

### ===========================================================================
### Smoke Test - Verify API is reachable
### ===========================================================================
### Expected: Some response from Strapi (200, 404, or similar - not connection error)

GET {{apiBase}}/ HTTP/1.1
Accept: application/json

### ===========================================================================
### Login - Get JWT Token
### ===========================================================================
### Expected: 200 OK with { "customer": {...}, "token": "eyJ..." }
###
### ⚠️ IMPORTANT: Copy the "token" value from the response and paste it
###    into CUSTOMER_TOKEN in your .env file!

POST {{apiBase}}/api/customers/login HTTP/1.1
Content-Type: application/json
Accept: application/json

{
  "email": "{{customerEmail}}",
  "password": "{{customerPassword}}"
}
